Implements semaphores along with mutexes to protect transfer of data.
